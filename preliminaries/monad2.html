<!doctype html>
<meta charset="utf-8">
<title>monad</title>
<script>
var optimist = function() {
	function next(){
		var args = getArguments.call(arguments);
		var currentFn = this.shift();
		if(!currentFn) return;	// done
		currentFn.apply(currentFn, [promise].concat(args));
	}
	
	var args = getArguments.call(arguments);
	var promise = { resolve: next.bind(args), reject: function(){ console.log("lort") } };
	return next.bind(args);
}

optimist(q1, q2, q3, q4, q5)("seed");

function iterator(fn) {
	for (var i = 0, len = this.length; i < len; ++i) {
		if( fn.call(this, this[i], i) === stop ) return;
	}
}
function getArguments() {
		return Array.prototype.splice.call(this, 0, this.length);
	}
function q1(promise, text) {
	console.log("q1", text);
    promise.resolve("Hello World");
}
function q2(promise, text) {
    console.log("q2", text);	// Hello World
    promise.resolve("from q2");
}
function q3(promise) {
    console.log("q3");
    setTimeout(ajax, 1000);
    function ajax() {
    	promise.resolve({ ok: true, status: 200 })
    }
    //promise.reject("from q3");
}
function q4(promise, data) {
    console.log("q4", data);
    promise.resolve();
}
function q5(promise) {
    console.log("q5");
}
</script>
</head>
<body>
	
</body>
</html>